<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Niskala Baca - Jagat Literasi</title>
    <meta
      name="description"
      content="Niskala Baca - Merawat Nalar, Menjaga Rasa."
    />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&family=Playfair+Display:ital,wght@0,700;1,400&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="navbar">
      <div
        class="container"
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
        "
      >
        <div
          style="
            font-weight: 700;
            font-size: 1.2rem;
            font-family: &quot;Playfair Display&quot;, serif;
          "
        >
          Niskala Baca.
        </div>
        <a
          href="login.html"
          style="font-size: 0.9rem; color: var(--text-muted); font-weight: 600"
        >
          <i class="ri-user-line"></i> Admin
        </a>
      </div>
    </nav>

    <header class="hero-section">
      <div class="container">
        <h1 class="hero-title">Niskala Baca</h1>
        <p class="hero-subtitle">
          "Membaca yang tak tersurat, memahami yang tersirat."
        </p>
      </div>
    </header>

    <main class="container">
      <div class="filter-container">
        <button class="filter-btn active" onclick="filterSelection('all')">
          Semua
        </button>
        <button class="filter-btn" onclick="filterSelection('filsafat')">
          Filsafat
        </button>
        <button class="filter-btn" onclick="filterSelection('psikologi')">
          Psikologi
        </button>
        <button class="filter-btn" onclick="filterSelection('puisi')">
          Puisi
        </button>
        <button class="filter-btn" onclick="filterSelection('news')">
          News
        </button>
        <button class="filter-btn" onclick="filterSelection('curhat')">
          Curhat
        </button>
      </div>

      <div class="grid-wrapper" id="content-container">
        <div style="grid-column: 1/-1; text-align: center; padding: 50px">
          <i
            class="ri-loader-4-line ri-spin"
            style="font-size: 2rem; color: var(--primary)"
          ></i>
          <p style="margin-top: 10px; color: var(--text-muted)">
            Sedang mengambil tulisan terbaru...
          </p>
        </div>
      </div>
    </main>

    <footer
      style="
        background: white;
        border-top: 1px solid var(--border);
        padding: 40px 0;
        margin-top: 60px;
        text-align: center;
      "
    >
      <div class="container">
        <h4
          style="
            font-family: &quot;Playfair Display&quot;, serif;
            font-size: 1.5rem;
            margin-bottom: 10px;
          "
        >
          Niskala Baca
        </h4>
        <p
          style="
            color: var(--text-muted);
            font-size: 0.9rem;
            max-width: 500px;
            margin: 0 auto 20px auto;
          "
        >
          Ruang tumbuh bagi pikiran yang ingin berkelana. Mari membaca dunia
          bersama.
        </p>
        <div style="font-size: 0.8rem; color: #94a3b8">
          &copy; 2026 Rahma Lindungi. All rights reserved.
        </div>
      </div>
    </footer>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
        query,
        orderBy,
      } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD8uUkLW_u53miixh_nF5k-QDakwlaMhwk",
        authDomain: "literasi-jagat.firebaseapp.com",
        projectId: "literasi-jagat",
        storageBucket: "literasi-jagat.firebasestorage.app",
        messagingSenderId: "538860113045",
        appId: "1:538860113045:web:6788735f7717dd7d6a1f9c",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function loadArticles() {
        const container = document.getElementById("content-container");
        try {
          const q = query(
            collection(db, "articles"),
            orderBy("tanggal", "desc"),
          );
          const querySnapshot = await getDocs(q);

          container.innerHTML = ""; // Bersihkan loading

          if (querySnapshot.empty) {
            container.innerHTML =
              "<p style='text-align:center; width:100%; grid-column:1/-1;'>Belum ada tulisan.</p>";
            return;
          }

          querySnapshot.forEach((doc) => {
            const data = doc.data();

            // Cek ada gambar atau tidak. Kalau tidak ada, pakai default pattern
            const gambarUrl =
              data.gambar ||
              "https://images.unsplash.com/photo-1507842217121-9e93c8ccc37c?auto=format&fit=crop&w=800&q=80";

            const card = document.createElement("div");
            card.className = `article-card ${data.kategori}`; // Class untuk filter

            card.innerHTML = `
                        <img src="${gambarUrl}" alt="${data.judul}" class="card-image">
                        <div class="card-content">
                            <div>
                                <span class="card-category">${data.kategori}</span>
                                <h3 class="card-title">${data.judul}</h3>
                                <p class="card-desc">${data.deskripsi}</p>
                            </div>
                            <div style="margin-top:auto; padding-top:20px;">
                                <a href="#" class="read-more" style="color:var(--primary); font-weight:700; font-size:0.9rem;">
                                    Baca Selengkapnya <i class="ri-arrow-right-line"></i>
                                </a>
                            </div>
                        </div>
                    `;
            container.appendChild(card);
          });
        } catch (error) {
          console.error(error);
          container.innerHTML =
            "<p style='color:red; text-align:center; grid-column:1/-1;'>Gagal memuat data. Cek koneksi.</p>";
        }
      }

      loadArticles();
    </script>

    <script>
      function filterSelection(category) {
        let cards = document.getElementsByClassName("article-card");
        if (category === "all") category = "";

        for (let i = 0; i < cards.length; i++) {
          cards[i].style.display = "none";
          if (cards[i].className.indexOf(category) > -1) {
            cards[i].style.display = "flex";
          }
        }

        // Update Active Button
        let btns = document.getElementsByClassName("filter-btn");
        for (let btn of btns) {
          btn.classList.remove("active");
          if (
            btn.innerText.toLowerCase() === category ||
            (category === "" && btn.innerText === "Semua")
          ) {
            btn.classList.add("active");
          }
        }
      }
    </script>
  </body>
</html>
